var week,urlArguments={},day=initDay;Date.prototype.getWeek=function(){var e=new Date(this.getFullYear(),0,1);return Math.ceil(((this-e)/864e5+e.getDay()+1)/7)};var getParams=function(e){var t={},n=document.createElement("a");n.href=e;for(var a=n.search.substring(1).split("&"),o=0;o<a.length;o++){var i=a[o].split("=");t[i[0]]=decodeURIComponent(i[1])}return t};function UpdateEntryInUrlArguments(e,t,n=!1){if(urlArguments[e]=t,n){var a=getParams(window.location.href);for(var o in a)""!=o&&(urlArguments[o]=a[o]);window.history.pushState("","","?"+$.param(urlArguments))}}function inputExceeded(){var e=$("#id-input-box"),t=$("<span >"+e.val()+"</span>");t.css({position:"absolute",left:-9999,top:-9999,"font-family":e.css("font-family"),"font-size":e.css("font-size"),"font-weight":e.css("font-weight"),"font-style":e.css("font-style")}),$("body").append(t);var n=t.width()>e.width();return t.remove(),n}var lastKnownID="ඞ";function checkIfIDTextFits(){var e=$("#id-input-box");if(e.val()!=lastKnownID||inputExceeded()){if(inputExceeded())for(;inputExceeded();){if((t=parseInt(e.css("--font-size"),10)-1)<1)break;e.css({"font-size":"min("+t+"px,24px)","--font-size":t+"px"})}else for(;!inputExceeded();){var t;if((t=parseInt(e.css("--font-size"),10)+1)>24)break;e.css({"font-size":"min("+t+"px,24px)","--font-size":t+"px"})}lastKnownID=e.val()}}function showSaved(){$("#schedule").addClass("menuBgBlur"),$(".menuIcon").removeClass("fa-bars").addClass("fa-times"),$(".savedList").empty(),$(".savedList").append("<li class='savedItems'>Tryck på länkarna för att ta bort dom</li>"),savedItems=getAllCookieNamesThatStartWith("URL_");for(var e=savedItems.length-1;e>=0;e--)savedItems[e].length>0&&$(".savedList").append('<li class="savedItems" onclick="eraseCookie(\''+savedItems[e]+"');showSaved();\">"+savedItems[e].replace("URL_","")+"</li>");console.log($(".savedList")),1==$(".savedItems").length?($(".savedList").empty(),$(".savedList").append("<li class='savedItems'>Du har inte sparat något URL</li>")):$(".savedList").append('<button class="clearSavedItems mobileSaved control-container" onclick="deleteAllURLCookies();">Ta bort alla</button>'),$(".savedIDs").fadeIn("fast")}function textBoxOpen(e){hideControls(),$(e).fadeIn(),$(".navbar").fadeOut(),$("#scheduleBox").fadeOut()}function textBoxClose(e){$(e).fadeOut(),$(".navbar").fadeIn(),$("#scheduleBox").fadeIn()}function savedItemClicked(e){$("#id-input-box").val(e.text()),$(".savedIDs").fadeOut("fast"),console.log("save inputed item in box"),updateTimetable()}function hideControls(){$(".controls").slideUp("fast",function(){$(this).is(":visible")?($(this).css("display","flex"),$("#schedule").addClass("menuBgBlur"),$(".menuIcon").removeClass("fa-bars").addClass("fa-times")):($("#schedule").removeClass("menuBgBlur"),$(".menuIcon").removeClass("fa-times").addClass("fa-bars"))})}function updateClipboard(e){navigator.clipboard.writeText(e).then(function(){console.log("YES")},function(){console.log("NO")})}function getShareableURL(){return $.ajax({url:requestURL+"API/SHAREABLE_URL?id="+$("#id-input-box").val(),async:!1}).responseJSON.result}function updateMenuButtonsBasedOnSize(){window.innerWidth<450?($("#button-text-day").html("Visa dag"),$("#button-text-qr").html("QR kod"),$("#button-text-private").html("Privat länk"),$("#button-text-copy").html("Kopiera länk"),$("#button-text-saved").html("Länkar")):($("#button-text-day").html("Visa bara dag&nbsp;&nbsp;"),$("#button-text-qr").html("Skapa QR kod&nbsp;&nbsp;"),$("#button-text-private").html("Skapa privat länk&nbsp;&nbsp;"),$("#button-text-copy").html("Kopiera privat länk&nbsp;&nbsp;"),$("#button-text-saved").html("Sparade länkar&nbsp;&nbsp;"))}function clickOn_QRCODE(){$("#button-text-qr").text("Laddar...");try{window.location.href=requestURL+"API/QR_CODE?id="+(privateURL?getShareableURL().id+"&p=1":$("#id-input-box").val()+"&p=0")}catch{$("#button-text-qr").text("ERROR!")}}function clickOn_SAVEDLINKS(){showSaved()}$(window).on("load",function(){function e(e,t,n){var a;return function(){var o=this,i=arguments,s=n&&!a;clearTimeout(a),a=setTimeout(function(){a=null,n||e.apply(o,i)},t),s&&e.apply(o,i)}}if(autoReloadSchedule){var t=new Date;setInterval(function(){0==(new Date).getHours()&&new Date-t>54e5&&location.reload()},1e4)}privateURL&&$("#id-input-box").css("display","none"),$(".text_box").hide(),hideControls(),$(".savedIDs").fadeOut(0),$("#input-day").prop("checked",initDayMode),""==initID?$("#id-input-box").val(readCookie("idnumber")):$("#id-input-box").val(initID),ignorecookiepolicy||"closed"!=readCookie("infoClosed")&&textBoxOpen("#text_cookies_info"),week=initWeek,$(".input-week").val(week),$(".arrow-center-text").text(week),$(".arrow-center").attr("title","Current week ("+week+")"),("closed"==readCookie("infoClosed")||ignorecookiepolicy)&&(console.log("load timetable after cookie info get"),updateTimetable()),updateMenuButtonsBasedOnSize(),checkIfIDTextFits();var n=e(function(){console.log("update timetable to fit new window size"),$("#schedule").fadeOut(500),checkIfIDTextFits(),updateMenuButtonsBasedOnSize(),updateTimetable()},250);window.addEventListener("resize",n),$(".arrow-left").on("click",function(){$(".arrow-left").addClass("arrow-loading"),$("#schedule").fadeOut(500,function(){$("#input-day").is(":checked")?(day-=1)<1&&(week-=1,day=5):week-=1,$(".input-week").val(week),updateTimetable()})}),$(".arrow-center").on("click",function(){$(".arrow-center").addClass("arrow-loading"),$("#schedule").fadeOut(500,function(){$("#input-day").is(":checked")&&$("#input-day").prop("checked",!1),week=initWeek,$(".input-week").val(initWeek),updateTimetable()})}),$(".arrow-right").on("click",function(){$(".arrow-right").addClass("arrow-loading"),$("#schedule").fadeOut(500,function(){$("#input-day").is(":checked")?(day+=1)>5&&(week+=1,day=1):week+=1,$(".input-week").val(week),updateTimetable()})});var a=e(function(){$("#schedule").fadeOut(500,function(){console.log("update timetable on related input (AFTER DEBOUNCE)"),updateTimetable()})},350);$("#id-input-box").on("input",a);a=e(function(){$("#schedule").fadeOut(500,function(){$("#id-input-box").val($("#id-input-box2").val()),""==$("#id-input-box").val()&&(""==initID?$("#id-input-box").val(readCookie("idnumber")):$("#id-input-box").val(initID)),updateTimetable()})},350);$("#id-input-box2").on("input",a),$(".input-week-container").on("click",function(){$(".input-week").focus()}),$(".input-week").on("click",function(){$(".input-week").focus()}),$(".input-week").on("input",function(){console.log("update timetable on related input 2"),updateTimetable()}),$("#input-day").on("click",function(){console.log("update timetable on related button click"),updateTimetable()}),$("#roundedMode").on("click",function(){console.log("update timetable on related button click 2"),updateTimetable()}),$(".menuButton").on("click",function(){$(".controls").slideToggle("fast",function(){$(this).is(":visible")?($(this).css("display","flex"),$("#schedule").addClass("menuBgBlur"),$(".menuIcon").removeClass("fa-bars").addClass("fa-times")):($("#schedule").removeClass("menuBgBlur"),$(".menuIcon").removeClass("fa-times").addClass("fa-bars"))})}),$("#schedule").on("click",function(){hideControls(),$(".input-idnumber").blur(),$(".savedIDs").fadeOut("fast"),checkIfIDTextFits()}),$(".input-idnumber").keypress(function(e){"13"==(e.keyCode?e.keyCode:e.which)&&(hideControls(),$(".input-idnumber").blur())}),$(".input-week").keypress(function(e){"13"==(e.keyCode?e.keyCode:e.which)&&hideControls()}),$(".savebutton").on("click",function(){hideControls()}),$(document).mouseup(function(e){var t=$(".savedIDs");t.is(e.target)||0!==t.has(e.target).length||t.fadeOut("fast")}),$(document).ready(function(){$("#scheduleBox").css("top",$(".navbar").height())}),showContactOnLoad&&textBoxOpen("#text_contact_info"),$(".loader-main").slideToggle(),console.log("script.js is loaded")});