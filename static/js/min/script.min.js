var week,urlArguments={},day=initDay,darkmode=initDarkMode,hideNavbar=initHideNavbar,oldURL="",school=initSchool;function range(e,t=0){return[...Array(e).keys()].map(e=>e+t)}function sleep(e,t){const o=Date.now();let n=null;do{n=Date.now()}while(n-o<e);try{t()}catch{}}String.prototype.replaceAt=function(e,t){return this.substr(0,e)+t+this.substr(e+t.length)},Date.prototype.getWeek=function(){var e=new Date(this.getFullYear(),0,1);return Math.ceil(((this-e)/864e5+e.getDay()+1)/7)};var toggleDarkMode_on="",toggleDarkModeAll_on="",toggleDarkMode_off="off";function toggleDarkMode(e=!1,t=!0,o=!0){function n(){var e=document.getElementById("darkmode"),t=document.getElementById("darkmodeAll");e.getAttribute("href")==toggleDarkMode_off?(e.setAttribute("href",toggleDarkMode_on),t.setAttribute("href",toggleDarkModeAll_on)):(e.setAttribute("href",toggleDarkMode_off),t.setAttribute("href",toggleDarkMode_off))}darkmode=$("#input-darkmode").prop("checked"),t&&createCookie("darkmode",darkmode?"1":"0",365),e?(n(),o&&updateTimetable()):($(".loader-main").slideToggle(500,function(){n(),o&&updateTimetable()}),$(".loader-main").slideToggle(500))}function inputExceeded(){var e=$("#id-input-box"),t=$("<span >"+e.val()+"</span>");t.css({position:"absolute",left:-9999,top:-9999,"font-family":e.css("font-family"),"font-size":e.css("font-size"),"font-weight":e.css("font-weight"),"font-style":e.css("font-style")}),$("body").append(t);var o=t.width()>e.width();return t.remove(),o}ignorecssmin?(toggleDarkModeAll_on="/static/css/darkmode-all.css",toggleDarkMode_on=mobileRequest?"/static/css/darkmode-mobile.css":"/static/css/darkmode-desktop.css"):(toggleDarkModeAll_on="/static/css/min/darkmode-all.min.css",toggleDarkMode_on=mobileRequest?"/static/css/min/darkmode-mobile.min.css":"/static/css/min/darkmode-desktop.min.css");var lastKnownID="ඞ";function checkIfIDTextFits(){var e=$("#id-input-box");if(e.val()!=lastKnownID||inputExceeded()){if(inputExceeded())for(;inputExceeded();){if((t=parseInt(e.css("--font-size"),10)-1)<1)break;e.css({"font-size":"min("+t+"px,24px)","--font-size":t+"px"})}else for(;!inputExceeded();){var t;if((t=parseInt(e.css("--font-size"),10)+1)>24)break;e.css({"font-size":"min("+t+"px,24px)","--font-size":t+"px"})}lastKnownID=e.val()}}function showSaved(){$("#schedule").addClass("menuBgBlur"),$(".menuIcon").removeClass("fa-bars").addClass("fa-times"),$(".savedList").empty(),$(".savedList").append("<li class='savedItems'>Tryck på länkarna för att ta bort dom</li>"),savedItems=getAllCookieNamesThatStartWith("URL_");for(var e=savedItems.length-1;e>=0;e--)savedItems[e].length>0&&$(".savedList").append('<li class="savedItems" onclick="eraseCookie(\''+savedItems[e]+"');showSaved();\">"+savedItems[e].replace("URL_","")+"</li>");console.log($(".savedList")),1==$(".savedItems").length?($(".savedList").empty(),$(".savedList").append("<li class='savedItems'>Du har inte sparat något URL</li>")):$(".savedList").append('<button class="clearSavedItems mobileSaved control-container" onclick="deleteAllURLCookies();">Ta bort alla</button>'),$(".savedIDs").fadeIn("fast")}function textBoxOpen(e){hideControls(),$(e).fadeIn(),$(".navbar").fadeOut(),$("#scheduleBox").fadeOut()}function textBoxClose(e){$(e).fadeOut(),$(".navbar").fadeIn(),$("#scheduleBox").fadeIn()}function savedItemClicked(e){$("#id-input-box").val(e.text()),$(".savedIDs").fadeOut("fast"),console.log("save inputed item in box"),updateTimetable()}function hideControls(){$(".controls").slideUp("fast",function(){$(this).is(":visible")?($(this).css("display","flex"),$("#schedule").addClass("menuBgBlur"),$(".menuIcon").removeClass("fa-bars").addClass("fa-times")):($("#schedule").removeClass("menuBgBlur"),$(".menuIcon").removeClass("fa-times").addClass("fa-bars"))})}function showControls(){$(".controls").slideToggle("fast",function(){$(".controls-container").fadeIn(0),$(this).is(":visible")?($(this).css("display","flex"),$("#schedule").addClass("menuBgBlur"),$(".menuIcon").removeClass("fa-bars").addClass("fa-times")):($("#schedule").removeClass("menuBgBlur"),$(".menuIcon").removeClass("fa-times").addClass("fa-bars"))})}function updateClipboard(e){navigator.clipboard.writeText(e).then(function(){console.log("YES")},function(){console.log("NO")})}function getShareableURL(){return $.ajax({url:requestURL+"API/SHAREABLE_URL?id="+$("#id-input-box").val()+"&school="+encodeURI(school),async:!1}).responseJSON.result}function updateMenuButtonsBasedOnSize(){window.innerWidth<450?($("#button-text-day").html("Visa dag"),$("#button-text-qr").html("QR kod"),$("#button-text-private").html("Privat länk"),$("#button-text-copy").html("Kopiera länk"),$("#button-text-saved").html("Länkar")):($("#button-text-day").html("Visa bara dag&nbsp;&nbsp;"),$("#button-text-qr").html("Skapa QR kod&nbsp;&nbsp;"),$("#button-text-private").html("Skapa privat länk&nbsp;&nbsp;"),$("#button-text-copy").html("Kopiera privat länk&nbsp;&nbsp;"),$("#button-text-saved").html("Sparade länkar&nbsp;&nbsp;"))}function clickOn_QRCODE(){$("#button-text-qr").text("Laddar...");try{window.location.href=requestURL+"API/QR_CODE?id="+(privateURL?getShareableURL().id+"&p=1":$("#id-input-box").val()+"&p=0")}catch{$("#button-text-qr").text("ERROR!")}}function clickOn_SAVEDLINKS(){showSaved(),$(".controls-container").fadeOut(0)}function f_showNavbar(){console.log("Showing navbar"),hideNavbar=!1,$(".navbar").show(),$("#scheduleBox").css({top:$(".navbar").height()+"px"}),updateTimetable()}function f_hideNavbar(){console.log("Hiding navbar"),hideNavbar=!0,$(".navbar").hide(),$("#scheduleBox").css({top:"0px"}),updateTimetable()}function schoolSelected(e){school=e,createCookie("school",e,365),textBoxClose("#text_school_selector"),updateTimetable(),$("#background-roller").fadeOut("fast")}$(window).on("load",function(){function e(e,t,o){var n;return function(){var a=this,i=arguments,s=o&&!n;clearTimeout(n),n=setTimeout(function(){n=null,o||e.apply(a,i)},t),s&&e.apply(a,i)}}if(autoReloadSchedule){var t=new Date;setInterval(function(){0==(new Date).getHours()&&new Date-t>54e5&&location.reload()},1e4)}if(null==initDarkMode&&(darkmode=null!=readCookie("darkmode")&&"1"==readCookie("darkmode")),0==darkmode&&toggleDarkMode(disableAnimation=!0,saveToCookie=!1,updateTimeTableAfter=!1),$("#input-darkmode").prop("checked",darkmode),privateURL&&$("#id-input-box").css("display","none"),"null"==initSchool)(ignorecookiepolicy||"closed"==readCookie("infoClosed"))&&textBoxOpen("#text_school_selector");else if(""!=initSchool)school=initSchool;else{let e=readCookie("school");isNaN(e)||null==e?(ignorecookiepolicy||"closed"==readCookie("infoClosed"))&&textBoxOpen("#text_school_selector"):school=e}$(".text_box").hide(),hideControls(),$(".savedIDs").fadeOut(0),$("#input-day").prop("checked",initDayMode),""==initID?$("#id-input-box").val(readCookie("idnumber")):$("#id-input-box").val(initID),ignorecookiepolicy||"closed"==readCookie("infoClosed")||textBoxOpen("#text_cookies_info"),week=initWeek,$(".input-week").val(week),$(".arrow-center-text").text(week),$(".arrow-center").attr("title","Current week ("+week+")"),updateMenuButtonsBasedOnSize(),checkIfIDTextFits();var o=e(function(){console.log("update timetable to fit new window size"),$("#schedule").fadeOut(500),updateMenuButtonsBasedOnSize(),updateTimetable(),checkIfIDTextFits()},250);window.addEventListener("resize",o),$(".arrow-left").on("click",function(){$(".arrow-left").addClass("arrow-loading"),$("#schedule").fadeOut(500,function(){$("#input-day").is(":checked")?(day-=1)<1&&(week-=1,day=5):week-=1,$(".input-week").val(week),updateTimetable()})}),$(".arrow-center").on("click",function(){$(".arrow-center").addClass("arrow-loading"),$("#schedule").fadeOut(500,function(){$("#input-day").is(":checked")&&$("#input-day").prop("checked",!1),week=initWeek,$(".input-week").val(initWeek),updateTimetable()})}),$(".arrow-right").on("click",function(){$(".arrow-right").addClass("arrow-loading"),$("#schedule").fadeOut(500,function(){$("#input-day").is(":checked")?(day+=1)>5&&(week+=1,day=1):week+=1,$(".input-week").val(week),updateTimetable()})});var n=e(function(){$("#schedule").fadeOut(500,function(){console.log("update timetable on related input (AFTER DEBOUNCE)"),updateTimetable()})},350);$("#id-input-box").on("input",n);n=e(function(){$("#schedule").fadeOut(500,function(){$("#id-input-box").val($("#id-input-box2").val()),""==$("#id-input-box").val()&&(""==initID?$("#id-input-box").val(readCookie("idnumber")):$("#id-input-box").val(initID)),updateTimetable()})},350);$("#id-input-box2").on("input",n),$(".input-week-container").on("click",function(){$(".input-week").focus()}),$(".input-week").on("click",function(){$(".input-week").focus()}),$(".input-week").on("input",function(){console.log("update timetable on related input 2"),updateTimetable()}),$("#input-day").on("click",function(){console.log("update timetable on related button click"),updateTimetable()}),$(".menuButton").on("click",function(){showControls()}),$("#schedule").on("click",function(){hideControls(),$(".input-idnumber").blur(),$(".savedIDs").fadeOut("fast"),checkIfIDTextFits()}),$(".input-idnumber").keypress(function(e){"13"==(e.keyCode?e.keyCode:e.which)&&(hideControls(),$(".input-idnumber").blur())}),$(".input-week").keypress(function(e){"13"==(e.keyCode?e.keyCode:e.which)&&hideControls()}),$(".savebutton").on("click",function(){hideControls()}),$(document).mouseup(function(e){var t=$(".savedIDs");t.is(e.target)||0!==t.has(e.target).length||t.fadeOut("fast")}),$(document).ready(function(){$("#scheduleBox").css("top",$(".navbar").height())}),showContactOnLoad&&textBoxOpen("#text_contact_info"),("closed"==readCookie("infoClosed")||ignorecookiepolicy)&&(console.log("load timetable after cookie info get"),updateTimetable()),hideNavbar&&f_hideNavbar(),$(".loader-main").slideToggle(),console.log("script.js is loaded")});